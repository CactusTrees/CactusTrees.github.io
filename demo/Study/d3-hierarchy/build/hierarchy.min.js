!function(n,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r(n.hierarchy={})}(this,function(n){"use strict";function r(n,r){for(var e=[n];null!=(n=e.pop());)if(r(n),(u=n.children)&&(t=u.length))for(var t,u;--t>=0;)e.push(u[t])}function e(n,r){for(var e=[n],t=[];null!=(n=e.pop());)if(t.push(n),(a=n.children)&&(u=a.length))for(var u,a,l=-1;++l<u;)e.push(a[l]);for(;null!=(n=t.pop());)r(n)}function t(n){var r=[];return n.forEach(function(n){n.children&&n.children.forEach(function(e){r.push({source:n,target:e})})}),r}function u(n){return n.children}function a(n){return n.value}function l(n,r){return r.value-n.value}function i(n,r){return n.sort=function(){var e=r.sort.apply(r,arguments);return e===r?n:e},n.children=function(){var e=r.children.apply(r,arguments);return e===r?n:e},n.value=function(){var e=r.value.apply(r,arguments);return e===r?n:e},n.nodes=n,n.links=t,n}function c(){function n(r){var t,u=[r],a=[];for(r.parent=null,r.depth=0;null!=(t=u.pop());)if(a.push(t),(f=c.call(n,t,t.depth))&&(l=f.length)){for(var l,f,h;--l>=0;)u.push(h=f[l]),h.parent=t,h.depth=t.depth+1;o&&(t.value=0),t.children=f}else o&&(t.value=+o.call(n,t,t.depth)||0),delete t.children;return e(r,function(n){var r,e;i&&(r=n.children)&&r.sort(i),o&&(e=n.parent)&&(e.value+=n.value)}),a}var i=l,c=u,o=a;return n.nodes=n,n.links=t,n.sort=function(r){return arguments.length?(i=r,n):i},n.children=function(r){return arguments.length?(c=r,n):c},n.value=function(r){return arguments.length?(o=r,n):o},n.revalue=function(t){return o&&(r(t,function(n){n.children&&(n.value=0)}),e(t,function(r){var e;r.children||(r.value=+o.call(n,r,r.depth)||0),(e=r.parent)&&(e.value+=r.value)})),t},n}function o(n){return{x:n.x,y:n.y,dx:n.dx,dy:n.dy}}function f(n,r){var e=n.x+r[3],t=n.y+r[0],u=n.dx-r[1]-r[3],a=n.dy-r[0]-r[2];return 0>u&&(e+=u/2,u=0),0>a&&(t+=a/2,a=0),{x:e,y:t,dx:u,dy:a}}function h(){function n(n){var r=x.call(h,n,n.depth);return null==r?o(n):f(n,"number"==typeof r?[r,r,r,r]:r)}function r(n){return f(n,x)}function e(n,r){for(var e,t,u=-1,a=n.length;++u<a;)t=(e=n[u]).value*(0>r?0:r),e.area=isNaN(t)||0>=t?0:t}function t(n){var r=n.children;if(r&&r.length){var u,i,c,o=y(n),f=[],h=r.slice(),d=1/0,p="slice"===m?o.dx:"dice"===m?o.dy:"slice-dice"===m?1&n.depth?o.dy:o.dx:Math.min(o.dx,o.dy);for(e(h,o.dx*o.dy/n.value),f.area=0;(c=h.length)>0;)f.push(u=h[c-1]),f.area+=u.area,"squarify"!==m||(i=a(f,p))<=d?(h.pop(),d=i):(f.area-=f.pop().area,l(f,p,o,!1),p=Math.min(o.dx,o.dy),f.length=f.area=0,d=1/0);f.length&&(l(f,p,o,!0),f.length=f.area=0),r.forEach(t)}}function u(n){var r=n.children;if(r&&r.length){var t,a=y(n),i=r.slice(),c=[];for(e(i,a.dx*a.dy/n.value),c.area=0;t=i.pop();)c.push(t),c.area+=t.area,null!=t.z&&(l(c,t.z?a.dx:a.dy,a,!i.length),c.length=c.area=0);r.forEach(u)}}function a(n,r){for(var e,t=n.area,u=0,a=1/0,l=-1,i=n.length;++l<i;)(e=n[l].area)&&(a>e&&(a=e),e>u&&(u=e));return t*=t,r*=r,t?Math.max(r*u*_/t,t/(r*a*_)):1/0}function l(n,r,e,t){var u,a=-1,l=n.length,i=e.x,c=e.y,o=r?v(n.area/r):0;if(r==e.dx){for((t||o>e.dy)&&(o=e.dy);++a<l;)u=n[a],u.x=i,u.y=c,u.dy=o,i+=u.dx=Math.min(e.x+e.dx-i,o?v(u.area/o):0);u.z=!0,u.dx+=e.x+e.dx-i,e.y+=o,e.dy-=o}else{for((t||o>e.dx)&&(o=e.dx);++a<l;)u=n[a],u.x=i,u.y=c,u.dx=o,c+=u.dy=Math.min(e.y+e.dy-c,o?v(u.area/o):0);u.z=!1,u.dy+=e.y+e.dy-c,e.x+=o,e.dx-=o}}function h(n){var r=d||p(n),a=r[0];return a.x=0,a.y=0,a.dx=s[0],a.dy=s[1],d&&p.revalue(a),e([a],a.dx*a.dy/a.value),(d?u:t)(a),g&&(d=r),r}var d,p=c(),v=Number,s=[1,1],x=null,y=o,g=!1,m="squarify",_=U;return h.size=function(n){return arguments.length?(s=[+n[0],+n[1]],h):s.slice()},h.padding=function(e){if(!arguments.length)return Array.isArray(x)?x.slice():x;var t;return y=null==e?(x=null,o):"function"==(t=typeof e)?(x=e,n):"number"===t?(x=[e,e,e,e],r):(x=[+e[0],+e[1],+e[2],+e[3]],r),h},h.round=function(n){return arguments.length?(v=n?Math.round:Number,h):v!==Number},h.sticky=function(n){return arguments.length?(g=!!n,d=null,h):g},h.ratio=function(n){return arguments.length?(_=+n,h):_},h.mode=function(n){return arguments.length?(m=V.hasOwnProperty(n)?n+"":"squarify",h):m},i(h,p)}function d(n,r){return n.parent===r.parent?1:2}function p(n){var r=n.children;return r.length?r[0]:n.t}function v(n){var r,e=n.children;return(r=e.length)?e[r-1]:n.t}function s(n,r,e){var t=e/(r.i-n.i);r.c-=t,r.s+=e,n.c+=t,r.z+=e,r.m+=e}function x(n){for(var r,e=0,t=0,u=n.children,a=u.length;--a>=0;)r=u[a],r.z+=e,r.m+=e,e+=r.s+(t+=r.c)}function y(n,r,e){return n.a.parent===r.parent?n.a:e}function g(){function n(n,l){var i=f.call(this,n,l),c=i[0],d=t(c);if(e(d,u),d.parent.m=-d.z,r(d,a),m)r(c,o);else{var p=c,v=c,s=c;r(c,function(n){n.x<p.x&&(p=n),n.x>v.x&&(v=n),n.depth>s.depth&&(s=n)});var x=h(p,v)/2-p.x,y=g[0]/(v.x+h(v,p)/2+x),_=g[1]/(s.depth||1);r(c,function(n){n.x=(n.x+x)*y,n.y=n.depth*_})}return i}function t(n){for(var r,e={A:null,children:[n]},t=[e];null!=(r=t.pop());)for(var u,a=r.children,l=0,i=a.length;i>l;++l)t.push((a[l]=u={_:a[l],parent:r,children:(u=a[l].children)&&u.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:l}).a=u);return e.children[0]}function u(n){var r=n.children,e=n.parent.children,t=n.i?e[n.i-1]:null;if(r.length){x(n);var u=(r[0].z+r[r.length-1].z)/2;t?(n.z=t.z+h(n._,t._),n.m=n.z-u):n.z=u}else t&&(n.z=t.z+h(n._,t._));n.parent.A=l(n,t,n.parent.A||e[0])}function a(n){n._.x=n.z+n.parent.m,n.m+=n.parent.m}function l(n,r,e){if(r){for(var t,u=n,a=n,l=r,i=u.parent.children[0],c=u.m,o=a.m,f=l.m,d=i.m;l=v(l),u=p(u),l&&u;)i=p(i),a=v(a),a.a=n,t=l.z+f-u.z-c+h(l._,u._),t>0&&(s(y(l,n,e),n,t),c+=t,o+=t),f+=l.m,c+=u.m,d+=i.m,o+=a.m;l&&!v(a)&&(a.t=l,a.m+=f-o),u&&!p(i)&&(i.t=u,i.m+=c-d,e=n)}return e}function o(n){n.x*=g[0],n.y=n.depth*g[1]}var f=c().sort(null).value(null),h=d,g=[1,1],m=null;return n.separation=function(r){return arguments.length?(h=r,n):h},n.size=function(r){return arguments.length?(m=null==(g=r)?o:null,n):m?null:g},n.nodeSize=function(r){return arguments.length?(m=null==(g=r)?null:o,n):m?g:null},i(n,f)}function m(n){var r,e,t=n.children,u=0;if(t)for(r=0,e=t.length;e>r;++r)u=Math.max(u,m(t[r]));return 1+u}function _(n,r,e,t){var u=n.children;if(n.x=r,n.y=n.depth*t,n.dx=e,n.dy=t,u&&(a=u.length)){var a,l,i,c=-1;for(e=n.value?e/n.value:0;++c<a;)_(l=u[c],r,i=l.value*e,t),r+=i}}function k(){function n(n,t){var u=r.call(this,n,t);return _(u[0],0,e[0],e[1]/m(u[0])),u}var r=c(),e=[1,1];return n.size=function(r){return arguments.length?(e=[+r[0],+r[1]],n):e.slice()},i(n,r)}function z(n){return b(M(n),[])}function M(n){for(var r,e=(n=n.slice()).length,t=null,u=t;e;){var a={id:n.length-e,value:n[e-1],next:null};u=u?u.next=a:t=a,n[r]=n[--e]}return{head:t,tail:u}}function b(n,r){var e,t,u,a=null,l=n.head;switch(r.length){case 1:e=r[0];break;case 2:e=A(r[0],r[1]);break;case 3:e=E(r[0],r[1],r[2])}for(;l;)u=l.value,t=l.next,e&&q(e,u)?a=l:(a?(n.tail=a,a.next=null):n.head=n.tail=null,r.push(u),e=b(n,r),r.pop(),n.head?(l.next=n.head,n.head=l):(l.next=null,n.head=n.tail=l),a=n.tail,a.next=t),l=t;return n.tail=a,e}function q(n,r){var e=n.x-r.x,t=n.y-r.y;return Math.sqrt(e*e+t*t)<n.r-r.r+1e-6}function A(n,r){var e=n.x,t=n.y,u=n.r,a=r.x,l=r.y,i=r.r,c=a-e,o=l-t,f=i-u,h=Math.sqrt(c*c+o*o);return{x:(e+a+c/h*f)/2,y:(t+l+o/h*f)/2,r:(h+u+i)/2}}function E(n,r,e){var t=n.x,u=n.y,a=n.r,l=r.x,i=r.y,c=r.r,o=e.x,f=e.y,h=e.r,d=2*(t-l),p=2*(u-i),v=2*(c-a),s=t*t+u*u-a*a-l*l-i*i+c*c,x=2*(t-o),y=2*(u-f),g=2*(h-a),m=t*t+u*u-a*a-o*o-f*f+h*h,_=x*p-d*y,k=(p*m-y*s)/_-t,z=(y*v-p*g)/_,M=(x*s-d*m)/_-u,b=(d*g-x*v)/_,q=z*z+b*b-1,A=2*(k*z+M*b+a),E=k*k+M*M-a*a,N=(-A-Math.sqrt(A*A-4*q*E))/(2*q);return{x:k+z*N+t,y:M+b*N+u,r:N}}function N(n,r){return n.value-r.value}function w(n,r){var e=n._pack_next;n._pack_next=r,r._pack_prev=n,r._pack_next=e,e._pack_prev=r}function S(n,r){n._pack_next=r,r._pack_prev=n}function j(n,r){var e=r.x-n.x,t=r.y-n.y,u=n.r+r.r;return.999*u*u>e*e+t*t}function O(n){if((r=n.children)&&(c=r.length)){var r,e,t,u,a,l,i,c;if(r.forEach(P),e=r[0],e.x=-e.r,e.y=0,c>1&&(t=r[1],t.x=t.r,t.y=0,c>2))for(u=r[2],D(e,t,u),w(e,u),e._pack_prev=u,w(u,t),t=e._pack_next,a=3;c>a;a++){D(e,t,u=r[a]);var o=0,f=1,h=1;for(l=t._pack_next;l!==t;l=l._pack_next,f++)if(j(l,u)){o=1;break}if(1==o)for(i=e._pack_prev;i!==l._pack_prev&&!j(i,u);i=i._pack_prev,h++);o?(h>f||f==h&&t.r<e.r?S(e,t=l):S(e=i,t),a--):(w(e,u),t=u)}var u=z(r);for(a=0;c>a;++a)e=r[a],e.x-=u.x,e.y-=u.y;n.r=u.r,r.forEach(B)}}function P(n){n._pack_next=n._pack_prev=n}function B(n){delete n._pack_next,delete n._pack_prev}function C(n,r,e,t){var u=n.children;if(n.x=r+=t*n.x,n.y=e+=t*n.y,n.r*=t,u)for(var a=-1,l=u.length;++a<l;)C(u[a],r,e,t)}function D(n,r,e){var t=n.r+e.r,u=r.x-n.x,a=r.y-n.y;if(t&&(u||a)){var l=r.r+e.r,i=u*u+a*a;l*=l,t*=t;var c=.5+(t-l)/(2*i),o=Math.sqrt(Math.max(0,2*l*(t+i)-(t-=i)*t-l*l))/(2*i);e.x=n.x+c*u+o*a,e.y=n.y+c*a-o*u}else e.x=n.x+t,e.y=n.y}function F(){function n(n,l){var i=t.call(this,n,l),c=i[0],o=a[0],f=a[1],h=null==r?Math.sqrt:"function"==typeof r?r:function(){return r};if(c.x=c.y=0,e(c,function(n){n.r=+h(n.value)}),e(c,O),u){var d=u*(r?1:Math.max(2*c.r/o,2*c.r/f))/2;e(c,function(n){n.r+=d}),e(c,O),e(c,function(n){n.r-=d})}return C(c,o/2,f/2,r?1:1/Math.max(2*c.r/o,2*c.r/f)),i}var r,t=c().sort(N),u=0,a=[1,1];return n.size=function(r){return arguments.length?(a=[+r[0],+r[1]],n):a.slice()},n.radius=function(e){return arguments.length?(r=null==e||"function"==typeof e?e:+e,n):r},n.padding=function(r){return arguments.length?(u=+r,n):u},i(n,t)}function G(n){return n.reduce(function(n,r){return n+r.x},0)/n.length}function H(n){return 1+n.reduce(function(n,r){return Math.max(n,r.y)},0)}function I(n){for(var r;(r=n.children)&&r.length;)n=r[0];return n}function J(n){for(var r,e;(r=n.children)&&(e=r.length);)n=r[e-1];return n}function K(){function n(n,l){var i,c=r.call(this,n,l),o=c[0],f=0;e(o,function(n){var r=n.children;r&&r.length?(n.x=G(r),n.y=H(r)):(n.x=i?f+=t(n,i):0,n.y=0,i=n)});var h=I(o),d=J(o),p=h.x-t(h,d)/2,v=d.x+t(d,h)/2;return e(o,a?function(n){n.x=(n.x-o.x)*u[0],n.y=(o.y-n.y)*u[1]}:function(n){n.x=(n.x-p)/(v-p)*u[0],n.y=(1-(o.y?n.y/o.y:1))*u[1]}),c}var r=c().sort(null).value(null),t=d,u=[1,1],a=!1;return n.separation=function(r){return arguments.length?(t=r,n):t},n.size=function(r){return arguments.length?(a=null==(u=r),n):a?null:u},n.nodeSize=function(r){return arguments.length?(a=null!=(u=r),n):a?u:null},i(n,r)}function L(){return function(n){for(var r,e=-1,t=n.length,u=new Array(t);++e<t;)r=n[e],u[e]=Q(r.source,r.end);return u}}function Q(n,r){for(var e=T(n,r),t=[n];n!==e;)n=n.parent,t.push(n);for(var u=t.length;r!==e;)t.splice(u,0,r),r=r.parent;return t}function R(n){for(var r=[],e=n.parent;null!=e;)r.push(n),n=e,e=e.parent;return r.push(n),r}function T(n,r){if(n===r)return n;var e=R(n),t=R(r),u=null;for(n=e.pop(),r=t.pop();n===r;)u=n,n=e.pop(),r=t.pop();return u}var U=(1+Math.sqrt(5))/2,V={slice:1,dice:1,"slice-dice":1,squarify:1};n.bundle=L,n.cluster=K,n.links=t,n.pack=F,n.partition=k,n.tree=g,n.treemap=h});